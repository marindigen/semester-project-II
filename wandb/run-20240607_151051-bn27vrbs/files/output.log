  0%|          | 0/50 [00:00<?, ?it/s] /Users/mariayuffa/semester-project-1/utils.py:160: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(masked_sequences, dtype=torch.long), masked_positions
100%|██████████| 32/32 [00:00<00:00, 57.97it/s]]
  2%|▏         | 1/50 [00:03<03:00,  3.69s/it]]
  0%|          | 0/157 [00:00<?, ?it/s]
Epoch 1 | Train Loss: 2.0875

100%|██████████| 32/32 [00:00<00:00, 60.62it/s]]
  4%|▍         | 2/50 [00:07<02:54,  3.63s/it]]
  3%|▎         | 4/157 [00:00<00:16,  9.02it/s]
Epoch 2 | Train Loss: 0.7030

 17%|█▋        | 26/157 [00:02<00:11, 11.32it/s]
100%|██████████| 32/32 [00:00<00:00, 64.95it/s]]
  6%|▌         | 3/50 [00:10<02:48,  3.58s/it]]
  6%|▌         | 9/157 [00:00<00:15,  9.67it/s]
 20%|██        | 32/157 [00:03<00:10, 11.55it/s]
  0%|          | 0/32 [00:00<?, ?it/s]
Epoch 4 | Train Loss: 0.6973
  8%|▊         | 4/50 [00:14<02:44,  3.58s/it]]
 20%|██        | 32/157 [00:03<00:11, 11.20it/s]
 62%|██████▎   | 20/32 [00:00<00:00, 61.72it/s]
Epoch 5 | Train Loss: 0.6964
 10%|█         | 5/50 [00:18<02:42,  3.61s/it]]
 20%|█▉        | 31/157 [00:03<00:12, 10.11it/s]
 56%|█████▋    | 18/32 [00:00<00:00, 53.87it/s]
Epoch 6 | Train Loss: 0.6975
 12%|█▏        | 6/50 [00:22<02:46,  3.79s/it]]
100%|██████████| 32/32 [00:00<00:00, 64.15it/s]]
 14%|█▍        | 7/50 [00:25<02:40,  3.73s/it]]
  1%|          | 1/157 [00:00<00:16,  9.70it/s]
Epoch 7 | Train Loss: 0.6937

 15%|█▍        | 23/157 [00:02<00:13, 10.25it/s]
100%|██████████| 32/32 [00:00<00:00, 60.51it/s]]
 16%|█▌        | 8/50 [00:29<02:34,  3.68s/it]]
  3%|▎         | 5/157 [00:00<00:15, 10.07it/s]

 16%|█▌        | 25/157 [00:02<00:14,  9.00it/s]
100%|██████████| 32/32 [00:00<00:00, 62.23it/s]]
 18%|█▊        | 9/50 [00:33<02:33,  3.75s/it]]
  4%|▍         | 6/157 [00:00<00:16,  9.34it/s]

 17%|█▋        | 27/157 [00:02<00:12, 10.30it/s]
100%|██████████| 32/32 [00:00<00:00, 58.96it/s]]
 20%|██        | 10/50 [00:37<02:30,  3.77s/it]
  5%|▌         | 8/157 [00:00<00:16,  9.18it/s]

 16%|█▌        | 25/157 [00:02<00:14,  9.38it/s]
100%|██████████| 32/32 [00:00<00:00, 61.27it/s]]
 22%|██▏       | 11/50 [00:41<02:30,  3.87s/it]
  5%|▌         | 8/157 [00:00<00:16,  9.17it/s]

 18%|█▊        | 29/157 [00:02<00:11, 11.28it/s]
Epoch 12 | Train Loss: 0.7115
100%|██████████| 32/32 [00:00<00:00, 63.54it/s]]
 24%|██▍       | 12/50 [00:44<02:23,  3.78s/it]
 20%|██        | 32/157 [00:03<00:10, 11.46it/s]
 62%|██████▎   | 20/32 [00:00<00:00, 62.88it/s]
Epoch 13 | Train Loss: 1.3678
 26%|██▌       | 13/50 [00:48<02:17,  3.72s/it]
100%|██████████| 32/32 [00:00<00:00, 62.10it/s]]
 28%|██▊       | 14/50 [00:52<02:13,  3.72s/it]
  1%|          | 1/157 [00:00<00:16,  9.18it/s]
Epoch 14 | Train Loss: 0.8748

 13%|█▎        | 21/157 [00:02<00:12, 10.65it/s]
100%|██████████| 32/32 [00:00<00:00, 63.18it/s]]
 30%|███       | 15/50 [00:55<02:07,  3.65s/it]
  4%|▍         | 6/157 [00:00<00:16,  9.40it/s]

 15%|█▍        | 23/157 [00:02<00:12, 10.66it/s]
100%|██████████| 32/32 [00:00<00:00, 41.68it/s]]
 32%|███▏      | 16/50 [00:59<02:11,  3.86s/it]
  2%|▏         | 3/157 [00:00<00:19,  8.03it/s]

100%|██████████| 32/32 [00:00<00:00, 57.50it/s]]
 34%|███▍      | 17/50 [01:03<02:07,  3.87s/it]
  3%|▎         | 5/157 [00:00<00:15,  9.80it/s]
Epoch 17 | Train Loss: 0.7033

 17%|█▋        | 26/157 [00:02<00:12, 10.17it/s]
100%|██████████| 32/32 [00:00<00:00, 63.87it/s]]
 36%|███▌      | 18/50 [01:07<02:01,  3.79s/it]
  5%|▌         | 8/157 [00:00<00:14, 10.03it/s]

 19%|█▉        | 30/157 [00:02<00:12, 10.54it/s]
Epoch 19 | Train Loss: 0.7157
100%|██████████| 32/32 [00:00<00:00, 62.79it/s]]
 38%|███▊      | 19/50 [01:11<01:56,  3.75s/it]
 20%|█▉        | 31/157 [00:03<00:11, 10.83it/s]
 44%|████▍     | 14/32 [00:00<00:00, 63.13it/s]
Epoch 20 | Train Loss: 0.6959
 40%|████      | 20/50 [01:14<01:51,  3.71s/it]
 20%|██        | 32/157 [00:03<00:10, 11.55it/s]
 44%|████▍     | 14/32 [00:00<00:00, 62.38it/s]
Epoch 21 | Train Loss: 0.6945
 42%|████▏     | 21/50 [01:18<01:46,  3.67s/it]
 20%|█▉        | 31/157 [00:03<00:11, 10.75it/s]
 81%|████████▏ | 26/32 [00:00<00:00, 62.83it/s]
Epoch 22 | Train Loss: 0.7016
 44%|████▍     | 22/50 [01:22<01:43,  3.71s/it]
100%|██████████| 32/32 [00:00<00:00, 66.60it/s]]
 46%|████▌     | 23/50 [01:25<01:38,  3.66s/it]
  3%|▎         | 4/157 [00:00<00:15,  9.63it/s]
Epoch 23 | Train Loss: 0.6978

 16%|█▌        | 25/157 [00:02<00:12, 10.95it/s]
100%|██████████| 32/32 [00:00<00:00, 63.53it/s]]
 48%|████▊     | 24/50 [01:29<01:34,  3.64s/it]
  5%|▌         | 8/157 [00:00<00:15,  9.76it/s]

 18%|█▊        | 28/157 [00:02<00:12, 10.70it/s]
Epoch 25 | Train Loss: 0.6964
100%|██████████| 32/32 [00:00<00:00, 63.73it/s]]
 50%|█████     | 25/50 [01:32<01:31,  3.66s/it]
 20%|█▉        | 31/157 [00:02<00:11, 11.00it/s]
 22%|██▏       | 7/32 [00:00<00:00, 64.46it/s]
Epoch 26 | Train Loss: 0.6983
 52%|█████▏    | 26/50 [01:36<01:27,  3.63s/it]
100%|██████████| 32/32 [00:00<00:00, 51.52it/s]]
 54%|█████▍    | 27/50 [01:40<01:23,  3.63s/it]
  0%|          | 0/157 [00:00<?, ?it/s]
Epoch 27 | Train Loss: 0.6948

100%|██████████| 32/32 [00:00<00:00, 64.45it/s]]
 56%|█████▌    | 28/50 [01:43<01:19,  3.61s/it]
  3%|▎         | 5/157 [00:00<00:16,  9.30it/s]
Epoch 28 | Train Loss: 0.7068

 17%|█▋        | 26/157 [00:02<00:12, 10.83it/s]
100%|██████████| 32/32 [00:00<00:00, 61.32it/s]]
 58%|█████▊    | 29/50 [01:47<01:15,  3.60s/it]
  6%|▌         | 9/157 [00:00<00:15,  9.73it/s]

 20%|█▉        | 31/157 [00:03<00:11, 11.21it/s]
Epoch 30 | Train Loss: 0.6975
100%|██████████| 32/32 [00:00<00:00, 59.10it/s]]
 60%|██████    | 30/50 [01:50<01:12,  3.61s/it]
 20%|██        | 32/157 [00:03<00:10, 11.84it/s]
 66%|██████▌   | 21/32 [00:00<00:00, 57.40it/s]
Epoch 31 | Train Loss: 0.7013
 62%|██████▏   | 31/50 [01:54<01:08,  3.60s/it]
100%|██████████| 32/32 [00:00<00:00, 62.20it/s]]
 64%|██████▍   | 32/50 [01:57<01:04,  3.59s/it]
  2%|▏         | 3/157 [00:00<00:16,  9.15it/s]
Epoch 32 | Train Loss: 0.7232

100%|██████████| 32/32 [00:00<00:00, 61.60it/s]]
 66%|██████▌   | 33/50 [02:01<01:01,  3.64s/it]
  3%|▎         | 5/157 [00:00<00:16,  9.35it/s]
Epoch 33 | Train Loss: 0.7270

 17%|█▋        | 27/157 [00:02<00:11, 11.08it/s]
100%|██████████| 32/32 [00:00<00:00, 63.05it/s]]
 68%|██████▊   | 34/50 [02:05<00:58,  3.63s/it]
  6%|▌         | 9/157 [00:00<00:15,  9.62it/s]
 20%|█▉        | 31/157 [00:02<00:11, 11.07it/s]
  0%|          | 0/32 [00:00<?, ?it/s]
Epoch 35 | Train Loss: 0.6975
 70%|███████   | 35/50 [02:08<00:53,  3.60s/it]
100%|██████████| 32/32 [00:00<00:00, 64.33it/s]]
 72%|███████▏  | 36/50 [02:12<00:49,  3.57s/it]
  1%|          | 1/157 [00:00<00:17,  8.95it/s]
Epoch 36 | Train Loss: 0.7132

100%|██████████| 32/32 [00:00<00:00, 62.27it/s]]
 74%|███████▍  | 37/50 [02:15<00:46,  3.55s/it]
  4%|▍         | 6/157 [00:00<00:15,  9.75it/s]
Epoch 37 | Train Loss: 0.7198

 17%|█▋        | 27/157 [00:02<00:12, 10.76it/s]
100%|██████████| 32/32 [00:00<00:00, 56.30it/s]]
 76%|███████▌  | 38/50 [02:19<00:43,  3.59s/it]
  5%|▌         | 8/157 [00:00<00:16,  8.94it/s]

 18%|█▊        | 28/157 [00:02<00:12,  9.98it/s]
100%|██████████| 32/32 [00:00<00:00, 54.93it/s]]
 78%|███████▊  | 39/50 [02:23<00:40,  3.68s/it]
  6%|▋         | 10/157 [00:01<00:16,  8.98it/s]

 19%|█▉        | 30/157 [00:03<00:12, 10.21it/s]
Epoch 40 | Train Loss: 0.6972
100%|██████████| 32/32 [00:00<00:00, 60.37it/s]]
 80%|████████  | 40/50 [02:27<00:37,  3.74s/it]

 17%|█▋        | 27/157 [00:02<00:12, 10.61it/s]
Epoch 41 | Train Loss: 5.1076

100%|██████████| 32/32 [00:00<00:00, 62.36it/s]]
/Users/mariayuffa/semester-project-1
Loaded train sequences of proteins sampled from Boltzmann distribution: (1000, 200)
Loaded test sequences of proteins sampled from Boltzmann distribution: (1000, 200)
Loaded train sequences of proteins for encoder distribution: (1000, 5, 200)
Loaded test sequences of proteins for encoder distribution: (1000, 5, 200)
mps