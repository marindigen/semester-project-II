  0%|          | 0/50 [00:00<?, ?it/s] /Users/mariayuffa/semester-project-1/utils.py:160: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(masked_sequences, dtype=torch.long), masked_positions

 19%|█▉        | 30/157 [00:03<00:13,  9.40it/s]
Epoch 1 | Train Loss: 1.5791
100%|██████████| 32/32 [00:00<00:00, 51.97it/s]]
  2%|▏         | 1/50 [00:04<03:32,  4.34s/it]]

 18%|█▊        | 28/157 [00:03<00:15,  8.31it/s]
Epoch 2 | Train Loss: 0.7120
100%|██████████| 32/32 [00:00<00:00, 38.18it/s]]
  4%|▍         | 2/50 [00:08<03:32,  4.43s/it]]

 13%|█▎        | 21/157 [00:02<00:21,  6.24it/s]
100%|██████████| 32/32 [00:00<00:00, 46.63it/s]]
  6%|▌         | 3/50 [00:13<03:34,  4.57s/it]]
  0%|          | 0/157 [00:00<?, ?it/s]

 20%|█▉        | 31/157 [00:03<00:15,  8.20it/s]
 16%|█▌        | 5/32 [00:00<00:00, 47.19it/s]
Epoch 4 | Train Loss: 0.7006
  8%|▊         | 4/50 [00:18<03:31,  4.61s/it]]

 16%|█▌        | 25/157 [00:03<00:18,  7.11it/s]
100%|██████████| 32/32 [00:00<00:00, 36.60it/s]]
 10%|█         | 5/50 [00:23<03:36,  4.80s/it]]
  1%|▏         | 2/157 [00:00<00:19,  7.90it/s]

 13%|█▎        | 20/157 [00:02<00:15,  8.88it/s]
100%|██████████| 32/32 [00:00<00:00, 47.77it/s]]
 12%|█▏        | 6/50 [00:27<03:24,  4.64s/it]]
  0%|          | 0/157 [00:00<?, ?it/s]

 10%|█         | 16/157 [00:01<00:16,  8.60it/s]
 20%|█▉        | 31/157 [00:03<00:14,  8.88it/s]
 69%|██████▉   | 22/32 [00:00<00:00, 44.25it/s]
 14%|█▍        | 7/50 [00:31<03:14,  4.52s/it]]
 20%|█▉        | 31/157 [00:03<00:14,  8.84it/s]
 19%|█▉        | 6/32 [00:00<00:00, 50.47it/s]
Epoch 8 | Train Loss: 0.7032
 16%|█▌        | 8/50 [00:36<03:06,  4.45s/it]]

 20%|█▉        | 31/157 [00:03<00:14,  8.78it/s]
Epoch 9 | Train Loss: 0.9439
100%|██████████| 32/32 [00:00<00:00, 49.78it/s]]
 18%|█▊        | 9/50 [00:40<03:00,  4.39s/it]]

 18%|█▊        | 29/157 [00:03<00:14,  8.97it/s]
Epoch 10 | Train Loss: 0.7715
100%|██████████| 32/32 [00:00<00:00, 46.85it/s]]
 20%|██        | 10/50 [00:45<02:56,  4.42s/it]

 17%|█▋        | 26/157 [00:02<00:14,  8.77it/s]
Epoch 11 | Train Loss: 0.7030
100%|██████████| 32/32 [00:00<00:00, 49.84it/s]]
 22%|██▏       | 11/50 [00:49<02:49,  4.35s/it]

 15%|█▌        | 24/157 [00:02<00:15,  8.77it/s]
Epoch 12 | Train Loss: 0.6984
100%|██████████| 32/32 [00:00<00:00, 48.91it/s]]
 24%|██▍       | 12/50 [00:53<02:44,  4.33s/it]

 13%|█▎        | 21/157 [00:02<00:15,  8.91it/s]
100%|██████████| 32/32 [00:00<00:00, 50.55it/s]]
 26%|██▌       | 13/50 [00:57<02:39,  4.31s/it]
  1%|▏         | 2/157 [00:00<00:17,  8.89it/s]

 13%|█▎        | 20/157 [00:02<00:15,  8.95it/s]
100%|██████████| 32/32 [00:00<00:00, 48.64it/s]]
 28%|██▊       | 14/50 [01:02<02:34,  4.30s/it]
  0%|          | 0/157 [00:00<?, ?it/s]

 20%|█▉        | 31/157 [00:03<00:14,  8.64it/s]
 47%|████▋     | 15/32 [00:00<00:00, 46.21it/s]
Epoch 15 | Train Loss: 0.7037
 30%|███       | 15/50 [01:06<02:31,  4.34s/it]

 20%|█▉        | 31/157 [00:03<00:14,  8.57it/s]
Epoch 16 | Train Loss: 0.7538
100%|██████████| 32/32 [00:00<00:00, 46.07it/s]]
 32%|███▏      | 16/50 [01:10<02:28,  4.36s/it]

 15%|█▌        | 24/157 [00:02<00:15,  8.85it/s]
Epoch 17 | Train Loss: 0.7338
100%|██████████| 32/32 [00:00<00:00, 48.75it/s]]
 34%|███▍      | 17/50 [01:15<02:23,  4.34s/it]

 14%|█▍        | 22/157 [00:02<00:15,  8.93it/s]
Epoch 18 | Train Loss: 0.7127
100%|██████████| 32/32 [00:00<00:00, 47.33it/s]]
 36%|███▌      | 18/50 [01:19<02:17,  4.31s/it]

 13%|█▎        | 20/157 [00:02<00:15,  8.77it/s]
Epoch 19 | Train Loss: 0.6987
100%|██████████| 32/32 [00:00<00:00, 48.59it/s]]
 38%|███▊      | 19/50 [01:23<02:13,  4.30s/it]

 11%|█         | 17/157 [00:02<00:15,  9.11it/s]
 20%|█▉        | 31/157 [00:03<00:13,  9.01it/s]
 66%|██████▌   | 21/32 [00:00<00:00, 48.02it/s]
 40%|████      | 20/50 [01:28<02:09,  4.31s/it]
 20%|█▉        | 31/157 [00:03<00:15,  8.32it/s]
  0%|          | 0/32 [00:00<?, ?it/s]
Epoch 21 | Train Loss: 0.7023
 42%|████▏     | 21/50 [01:32<02:06,  4.36s/it]

 18%|█▊        | 29/157 [00:03<00:14,  8.84it/s]
Epoch 22 | Train Loss: 0.6934
100%|██████████| 32/32 [00:00<00:00, 51.37it/s]]
 44%|████▍     | 22/50 [01:36<02:01,  4.34s/it]

 17%|█▋        | 26/157 [00:03<00:15,  8.65it/s]
Epoch 23 | Train Loss: 0.7076
100%|██████████| 32/32 [00:00<00:00, 47.55it/s]]
 46%|████▌     | 23/50 [01:41<01:57,  4.35s/it]

 15%|█▌        | 24/157 [00:02<00:15,  8.84it/s]
Epoch 24 | Train Loss: 0.7287
100%|██████████| 32/32 [00:00<00:00, 47.98it/s]]
 48%|████▊     | 24/50 [01:45<01:52,  4.33s/it]

 14%|█▍        | 22/157 [00:02<00:15,  8.82it/s]
Epoch 25 | Train Loss: 0.7741
100%|██████████| 32/32 [00:00<00:00, 51.29it/s]]
 50%|█████     | 25/50 [01:49<01:47,  4.29s/it]

 13%|█▎        | 21/157 [00:02<00:14,  9.25it/s]
100%|██████████| 32/32 [00:00<00:00, 48.01it/s]]
 52%|█████▏    | 26/50 [01:53<01:42,  4.27s/it]
  1%|          | 1/157 [00:00<00:16,  9.31it/s]

 12%|█▏        | 19/157 [00:02<00:15,  8.85it/s]
 20%|█▉        | 31/157 [00:03<00:14,  8.81it/s]
 81%|████████▏ | 26/32 [00:00<00:00, 38.67it/s]
 54%|█████▍    | 27/50 [01:58<01:38,  4.29s/it]
 20%|█▉        | 31/157 [00:03<00:13,  9.09it/s]
 47%|████▋     | 15/32 [00:00<00:00, 46.96it/s]
Epoch 28 | Train Loss: 0.7216
 56%|█████▌    | 28/50 [02:02<01:33,  4.27s/it]
 20%|█▉        | 31/157 [00:03<00:14,  8.81it/s]
 16%|█▌        | 5/32 [00:00<00:00, 47.50it/s]
Epoch 29 | Train Loss: 0.7226
 58%|█████▊    | 29/50 [02:06<01:29,  4.28s/it]

 20%|█▉        | 31/157 [00:03<00:14,  8.74it/s]
Epoch 30 | Train Loss: 0.7216
100%|██████████| 32/32 [00:00<00:00, 49.62it/s]]
 60%|██████    | 30/50 [02:10<01:25,  4.27s/it]

 18%|█▊        | 29/157 [00:03<00:14,  9.02it/s]
Epoch 31 | Train Loss: 0.7057
100%|██████████| 32/32 [00:00<00:00, 49.24it/s]]
 62%|██████▏   | 31/50 [02:15<01:20,  4.26s/it]

 17%|█▋        | 27/157 [00:03<00:14,  9.20it/s]
Epoch 32 | Train Loss: 0.7220
100%|██████████| 32/32 [00:00<00:00, 48.82it/s]]
 64%|██████▍   | 32/50 [02:19<01:16,  4.27s/it]

 16%|█▌        | 25/157 [00:02<00:14,  8.81it/s]
Epoch 33 | Train Loss: 0.7012
100%|██████████| 32/32 [00:00<00:00, 48.00it/s]]
 66%|██████▌   | 33/50 [02:23<01:12,  4.26s/it]

 11%|█▏        | 18/157 [00:02<00:15,  8.97it/s]
 20%|█▉        | 31/157 [00:03<00:14,  8.68it/s]
 69%|██████▉   | 22/32 [00:00<00:00, 47.95it/s]
 68%|██████▊   | 34/50 [02:28<01:08,  4.26s/it]
 10%|█         | 16/157 [00:01<00:16,  8.75it/s]
 20%|█▉        | 31/157 [00:03<00:14,  8.77it/s]
 47%|████▋     | 15/32 [00:00<00:00, 48.86it/s]
 70%|███████   | 35/50 [02:32<01:03,  4.27s/it]
  9%|▉         | 14/157 [00:01<00:16,  8.79it/s]
 20%|█▉        | 31/157 [00:03<00:14,  8.77it/s]
  0%|          | 0/32 [00:00<?, ?it/s]
 72%|███████▏  | 36/50 [02:36<01:00,  4.32s/it]

 18%|█▊        | 28/157 [00:03<00:14,  8.77it/s]
Epoch 37 | Train Loss: 0.7120
100%|██████████| 32/32 [00:00<00:00, 49.64it/s]]
 74%|███████▍  | 37/50 [02:40<00:55,  4.30s/it]

 17%|█▋        | 26/157 [00:02<00:15,  8.48it/s]
Epoch 38 | Train Loss: 0.7162
100%|██████████| 32/32 [00:00<00:00, 48.86it/s]]
 76%|███████▌  | 38/50 [02:45<00:51,  4.31s/it]

 15%|█▌        | 24/157 [00:02<00:14,  8.90it/s]
Epoch 39 | Train Loss: 0.7386
100%|██████████| 32/32 [00:00<00:00, 48.87it/s]]
 78%|███████▊  | 39/50 [02:49<00:47,  4.29s/it]

 14%|█▍        | 22/157 [00:02<00:15,  8.78it/s]
100%|██████████| 32/32 [00:00<00:00, 49.14it/s]]
 80%|████████  | 40/50 [02:53<00:42,  4.29s/it]
  1%|          | 1/157 [00:00<00:34,  4.49it/s]

 12%|█▏        | 19/157 [00:02<00:16,  8.53it/s]
 20%|█▉        | 31/157 [00:03<00:13,  9.09it/s]
 78%|███████▊  | 25/32 [00:00<00:00, 47.96it/s]
 82%|████████▏ | 41/50 [02:58<00:38,  4.33s/it]
 20%|█▉        | 31/157 [00:03<00:14,  8.94it/s]
 47%|████▋     | 15/32 [00:00<00:00, 47.86it/s]
Epoch 42 | Train Loss: 0.7587
 84%|████████▍ | 42/50 [03:02<00:34,  4.30s/it]
 20%|█▉        | 31/157 [00:03<00:15,  8.32it/s]
 16%|█▌        | 5/32 [00:00<00:00, 49.09it/s]
Epoch 43 | Train Loss: 0.7145
 86%|████████▌ | 43/50 [03:06<00:30,  4.30s/it]

 18%|█▊        | 29/157 [00:03<00:14,  8.98it/s]
Epoch 44 | Train Loss: 0.7308
100%|██████████| 32/32 [00:00<00:00, 46.85it/s]]
 88%|████████▊ | 44/50 [03:11<00:25,  4.33s/it]

 17%|█▋        | 27/157 [00:03<00:15,  8.53it/s]
Epoch 45 | Train Loss: 0.7507
100%|██████████| 32/32 [00:00<00:00, 48.24it/s]]
 90%|█████████ | 45/50 [03:15<00:21,  4.33s/it]

 16%|█▌        | 25/157 [00:02<00:14,  8.83it/s]
Epoch 46 | Train Loss: 0.7030
100%|██████████| 32/32 [00:00<00:00, 49.10it/s]]
 92%|█████████▏| 46/50 [03:19<00:17,  4.31s/it]

 14%|█▍        | 22/157 [00:02<00:15,  8.82it/s]
100%|██████████| 32/32 [00:00<00:00, 48.10it/s]]
 94%|█████████▍| 47/50 [03:24<00:12,  4.30s/it]
  1%|▏         | 2/157 [00:00<00:17,  8.82it/s]

 13%|█▎        | 20/157 [00:02<00:15,  8.92it/s]
100%|██████████| 32/32 [00:00<00:00, 49.47it/s]]
 96%|█████████▌| 48/50 [03:28<00:08,  4.32s/it]
  0%|          | 0/157 [00:00<?, ?it/s]

 20%|█▉        | 31/157 [00:03<00:14,  8.91it/s]
 62%|██████▎   | 20/32 [00:00<00:00, 46.50it/s]
Epoch 49 | Train Loss: 0.7344
 10%|▉         | 15/157 [00:01<00:16,  8.77it/s]
 18%|█▊        | 29/157 [00:03<00:14,  8.68it/s]
 18%|█▊        | 29/157 [00:03<00:14,  8.68it/s]
Epoch 50 | Train Loss: 0.7109
                                               ]
                                               ]
Cross-attention weights: torch.Size([8, 200, 200])
Self-attention weights: torch.Size([8, 200, 200])
Cross-attention weights: torch.Size([8, 200, 200])
(200, 200)
Cross-attention weights: torch.Size([8, 200, 200])
