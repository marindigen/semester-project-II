  0%|          | 0/50 [00:00<?, ?it/s] /Users/mariayuffa/semester-project-1/train.py:92: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  input_seq_enc = torch.tensor(input_seq_enc, dtype=torch.long)
/Users/mariayuffa/semester-project-1/utils.py:160: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(masked_sequences, dtype=torch.long), masked_positions
 20%|█▉        | 31/157 [00:03<00:12,  9.91it/s]
  6%|▌         | 9/157 [00:00<00:05, 26.70it/s]
Epoch 1 | Train Loss: 0.9168
  2%|▏         | 1/50 [00:04<03:51,  4.72s/it]s]

 20%|█▉        | 31/157 [00:03<00:11, 10.80it/s]
 20%|██        | 32/157 [00:01<00:05, 24.20it/s]
  4%|▍         | 2/50 [00:09<03:39,  4.57s/it]s]
  3%|▎         | 5/157 [00:00<00:17,  8.49it/s]

 16%|█▌        | 25/157 [00:02<00:12, 10.20it/s]
 20%|██        | 32/157 [00:01<00:04, 27.93it/s]
  6%|▌         | 3/50 [00:13<03:30,  4.48s/it]s]
  2%|▏         | 3/157 [00:00<00:16,  9.60it/s]

 14%|█▍        | 22/157 [00:02<00:13, 10.13it/s]
 20%|██        | 32/157 [00:01<00:04, 28.82it/s]
  8%|▊         | 4/50 [00:17<03:21,  4.38s/it]s]
  1%|          | 1/157 [00:00<00:16,  9.59it/s]

 20%|█▉        | 31/157 [00:03<00:13,  9.16it/s]
 10%|█         | 16/157 [00:00<00:04, 28.64it/s]
Epoch 5 | Train Loss: 0.7089
 10%|█         | 5/50 [00:22<03:21,  4.49s/it]s]
 20%|██        | 32/157 [00:03<00:11, 11.17it/s]
  8%|▊         | 12/157 [00:00<00:05, 28.48it/s]
Epoch 6 | Train Loss: 0.6986
 12%|█▏        | 6/50 [00:26<03:12,  4.38s/it]s]
 20%|█▉        | 31/157 [00:03<00:12, 10.29it/s]
  4%|▍         | 6/157 [00:00<00:05, 26.41it/s]
Epoch 7 | Train Loss: 0.6960
 14%|█▍        | 7/50 [00:30<03:06,  4.33s/it]s]

 17%|█▋        | 27/157 [00:03<00:16,  7.94it/s]
 20%|█▉        | 31/157 [00:03<00:13,  9.09it/s]
 16%|█▌        | 25/157 [00:01<00:07, 18.19it/s]
 16%|█▌        | 8/50 [00:36<03:16,  4.68s/it]s]
 20%|█▉        | 31/157 [00:03<00:11, 10.57it/s]
  4%|▍         | 6/157 [00:00<00:05, 28.27it/s]
Epoch 9 | Train Loss: 0.7018
 18%|█▊        | 9/50 [00:40<03:11,  4.68s/it]s]

 19%|█▉        | 30/157 [00:03<00:13,  9.67it/s]
 20%|██        | 32/157 [00:01<00:04, 30.21it/s]
 20%|██        | 10/50 [00:45<03:02,  4.57s/it]]
  5%|▌         | 8/157 [00:00<00:16,  9.03it/s]

 18%|█▊        | 29/157 [00:02<00:11, 10.94it/s]
 20%|██        | 32/157 [00:01<00:04, 28.61it/s]
 22%|██▏       | 11/50 [00:49<02:53,  4.46s/it]]
  4%|▍         | 6/157 [00:00<00:15,  9.84it/s]

 17%|█▋        | 26/157 [00:02<00:12, 10.61it/s]
 20%|██        | 32/157 [00:01<00:04, 27.66it/s]
 24%|██▍       | 12/50 [00:53<02:47,  4.42s/it]]
  2%|▏         | 3/157 [00:00<00:17,  9.01it/s]

 16%|█▌        | 25/157 [00:02<00:11, 11.01it/s]
 20%|██        | 32/157 [00:01<00:04, 25.75it/s]
 26%|██▌       | 13/50 [00:58<02:42,  4.39s/it]]
  1%|          | 1/157 [00:00<00:16,  9.38it/s]

 11%|█         | 17/157 [00:01<00:14,  9.99it/s]
 20%|█▉        | 31/157 [00:03<00:11, 10.70it/s]
 18%|█▊        | 29/157 [00:00<00:04, 30.23it/s]
 28%|██▊       | 14/50 [01:02<02:36,  4.34s/it]]
 12%|█▏        | 19/157 [00:01<00:13, 10.41it/s]
 20%|█▉        | 31/157 [00:02<00:11, 11.13it/s]
 18%|█▊        | 29/157 [00:00<00:04, 30.56it/s]
 30%|███       | 15/50 [01:06<02:29,  4.26s/it]]
 20%|██        | 32/157 [00:03<00:10, 11.61it/s]
 15%|█▌        | 24/157 [00:00<00:04, 30.08it/s]
Epoch 16 | Train Loss: 0.6962
 32%|███▏      | 16/50 [01:10<02:23,  4.21s/it]]
 20%|█▉        | 31/157 [00:03<00:11, 11.20it/s]
 11%|█▏        | 18/157 [00:00<00:04, 28.94it/s]
Epoch 17 | Train Loss: 0.6937
 34%|███▍      | 17/50 [01:14<02:20,  4.26s/it]]
 20%|██        | 32/157 [00:03<00:11, 11.03it/s]
 10%|▉         | 15/157 [00:00<00:04, 29.15it/s]
Epoch 18 | Train Loss: 0.6948
 36%|███▌      | 18/50 [01:19<02:15,  4.23s/it]]

 19%|█▉        | 30/157 [00:02<00:11, 10.90it/s]
Epoch 19 | Train Loss: 0.6940
 20%|██        | 32/157 [00:01<00:03, 31.28it/s]
 38%|███▊      | 19/50 [01:23<02:09,  4.18s/it]]

 18%|█▊        | 28/157 [00:02<00:11, 11.16it/s]
 20%|██        | 32/157 [00:01<00:04, 30.47it/s]
 40%|████      | 20/50 [01:27<02:05,  4.17s/it]]
  4%|▍         | 6/157 [00:00<00:16,  9.04it/s]

 17%|█▋        | 26/157 [00:02<00:12, 10.81it/s]
 20%|██        | 32/157 [00:01<00:04, 29.08it/s]
 42%|████▏     | 21/50 [01:31<02:01,  4.17s/it]]
  3%|▎         | 5/157 [00:00<00:15,  9.53it/s]

 17%|█▋        | 26/157 [00:02<00:11, 10.98it/s]
 20%|██        | 32/157 [00:01<00:04, 29.90it/s]
 44%|████▍     | 22/50 [01:35<01:56,  4.15s/it]]
  3%|▎         | 5/157 [00:00<00:15,  9.61it/s]

 17%|█▋        | 26/157 [00:02<00:12, 10.38it/s]
 20%|██        | 32/157 [00:01<00:05, 24.82it/s]
 46%|████▌     | 23/50 [01:39<01:53,  4.22s/it]]
  1%|          | 1/157 [00:00<00:18,  8.65it/s]

 13%|█▎        | 21/157 [00:02<00:13, 10.00it/s]
 20%|██        | 32/157 [00:01<00:04, 30.88it/s]
 48%|████▊     | 24/50 [01:44<01:48,  4.18s/it]]
  1%|          | 1/157 [00:00<00:16,  9.34it/s]

 13%|█▎        | 21/157 [00:02<00:13, 10.18it/s]
 20%|█▉        | 31/157 [00:03<00:11, 10.67it/s]
 15%|█▌        | 24/157 [00:00<00:04, 28.46it/s]
 50%|█████     | 25/50 [01:48<01:46,  4.25s/it]]
 20%|██        | 32/157 [00:03<00:10, 11.51it/s]
 14%|█▍        | 22/157 [00:00<00:04, 29.93it/s]
Epoch 26 | Train Loss: 0.6953
 52%|█████▏    | 26/50 [01:52<01:41,  4.21s/it]]
 20%|██        | 32/157 [00:02<00:10, 11.47it/s]
 14%|█▍        | 22/157 [00:00<00:04, 28.05it/s]
Epoch 27 | Train Loss: 0.6980
 54%|█████▍    | 27/50 [01:56<01:35,  4.17s/it]]
 20%|██        | 32/157 [00:02<00:10, 11.52it/s]
 13%|█▎        | 21/157 [00:00<00:04, 28.55it/s]
Epoch 28 | Train Loss: 0.6942
 56%|█████▌    | 28/50 [02:00<01:31,  4.15s/it]]
 20%|██        | 32/157 [00:03<00:11, 11.21it/s]
  6%|▌         | 9/157 [00:00<00:05, 28.83it/s]
Epoch 29 | Train Loss: 0.6935
 58%|█████▊    | 29/50 [02:05<01:28,  4.23s/it]]
 20%|██        | 32/157 [00:02<00:10, 11.83it/s]
  4%|▍         | 7/157 [00:00<00:04, 30.53it/s]
Epoch 30 | Train Loss: 0.6939
 60%|██████    | 30/50 [02:09<01:23,  4.18s/it]]
 20%|█▉        | 31/157 [00:02<00:11, 11.37it/s]
  3%|▎         | 4/157 [00:00<00:05, 29.81it/s]
Epoch 31 | Train Loss: 0.6941
 62%|██████▏   | 31/50 [02:13<01:19,  4.16s/it]]
 20%|██        | 32/157 [00:02<00:10, 11.39it/s]
  3%|▎         | 4/157 [00:00<00:05, 30.56it/s]
Epoch 32 | Train Loss: 0.6947
 64%|██████▍   | 32/50 [02:17<01:14,  4.16s/it]]

 18%|█▊        | 29/157 [00:02<00:12, 10.18it/s]
 20%|██        | 32/157 [00:01<00:04, 29.04it/s]
 66%|██████▌   | 33/50 [02:21<01:11,  4.22s/it]]
  4%|▍         | 7/157 [00:00<00:14, 10.38it/s]

 17%|█▋        | 27/157 [00:02<00:12, 10.76it/s]
 20%|██        | 32/157 [00:01<00:04, 30.38it/s]
 68%|██████▊   | 34/50 [02:25<01:06,  4.17s/it]]
  4%|▍         | 6/157 [00:00<00:16,  9.36it/s]

 18%|█▊        | 28/157 [00:02<00:11, 10.97it/s]
 20%|██        | 32/157 [00:01<00:04, 28.49it/s]
 70%|███████   | 35/50 [02:30<01:02,  4.17s/it]]
  3%|▎         | 4/157 [00:00<00:16,  9.28it/s]

 16%|█▌        | 25/157 [00:02<00:11, 11.23it/s]
 20%|██        | 32/157 [00:01<00:04, 28.71it/s]
 72%|███████▏  | 36/50 [02:34<00:58,  4.16s/it]]
  3%|▎         | 4/157 [00:00<00:16,  9.36it/s]

 15%|█▌        | 24/157 [00:02<00:12, 11.07it/s]
 20%|██        | 32/157 [00:03<00:11, 11.15it/s]
 17%|█▋        | 27/157 [00:00<00:04, 29.02it/s]
 74%|███████▍  | 37/50 [02:38<00:54,  4.16s/it]]
 11%|█▏        | 18/157 [00:01<00:14,  9.62it/s]
 20%|█▉        | 31/157 [00:03<00:12,  9.73it/s]
  8%|▊         | 13/157 [00:00<00:04, 29.16it/s]
 76%|███████▌  | 38/50 [02:42<00:51,  4.26s/it]]
 20%|██        | 32/157 [00:03<00:11, 11.21it/s]
  4%|▍         | 6/157 [00:00<00:05, 28.54it/s]
Epoch 39 | Train Loss: 0.6958
 78%|███████▊  | 39/50 [02:47<00:46,  4.25s/it]]
 20%|██        | 32/157 [00:03<00:10, 11.67it/s]
  2%|▏         | 3/157 [00:00<00:05, 28.64it/s]
Epoch 40 | Train Loss: 0.6943
 80%|████████  | 40/50 [02:51<00:42,  4.22s/it]]
 20%|██        | 32/157 [00:03<00:11, 11.33it/s]
  0%|          | 0/157 [00:00<?, ?it/s]
 82%|████████▏ | 41/50 [02:55<00:38,  4.26s/it]]
  4%|▍         | 7/157 [00:00<00:15,  9.60it/s]

 17%|█▋        | 27/157 [00:02<00:13,  9.71it/s]
 20%|██        | 32/157 [00:01<00:04, 26.28it/s]
 84%|████████▍ | 42/50 [03:00<00:34,  4.31s/it]]
  2%|▏         | 3/157 [00:00<00:16,  9.17it/s]

 20%|█▉        | 31/157 [00:03<00:13,  9.12it/s]
 10%|▉         | 15/157 [00:00<00:07, 19.92it/s]
Epoch 43 | Train Loss: 0.6942
 86%|████████▌ | 43/50 [03:05<00:31,  4.52s/it]]
 20%|█▉        | 31/157 [00:03<00:12,  9.90it/s]
  2%|▏         | 3/157 [00:00<00:05, 27.41it/s]
 88%|████████▊ | 44/50 [03:09<00:27,  4.54s/it]]
  4%|▍         | 6/157 [00:00<00:16,  9.13it/s]

 16%|█▌        | 25/157 [00:02<00:15,  8.63it/s]
 20%|██        | 32/157 [00:01<00:04, 30.30it/s]
 90%|█████████ | 45/50 [03:14<00:22,  4.55s/it]]
  2%|▏         | 3/157 [00:00<00:15,  9.98it/s]

 14%|█▍        | 22/157 [00:02<00:13, 10.32it/s]
 20%|██        | 32/157 [00:03<00:11, 11.14it/s]
 18%|█▊        | 29/157 [00:01<00:04, 26.31it/s]
 92%|█████████▏| 46/50 [03:18<00:18,  4.52s/it]]
 20%|█▉        | 31/157 [00:03<00:12, 10.45it/s]
 11%|█         | 17/157 [00:00<00:04, 29.22it/s]
Epoch 47 | Train Loss: 0.6944
 94%|█████████▍| 47/50 [03:23<00:13,  4.49s/it]]
 20%|██        | 32/157 [00:03<00:11, 10.50it/s]
  6%|▌         | 9/157 [00:00<00:05, 29.19it/s]
Epoch 48 | Train Loss: 0.6952
  7%|▋         | 11/157 [00:01<00:13, 10.47it/s]
  2%|▏         | 3/157 [00:00<00:05, 27.85it/s]]
  2%|▏         | 3/157 [00:00<00:05, 27.85it/s]]
Epoch 49 | Train Loss: 0.6956
  5%|▌         | 8/157 [00:00<00:15,  9.59it/s]]
  0%|          | 0/157 [00:00<?, ?it/s]0.52it/s]
  0%|          | 0/157 [00:00<?, ?it/s]0.52it/s]
                                               ]
                                               ]
Epoch 50 | Eval Loss: 0.1414
/Users/mariayuffa/semester-project-1
Loaded train sequences of proteins sampled from Boltzmann distribution: (1000, 200)
Loaded test sequences of proteins sampled from Boltzmann distribution: (1000, 200)
Loaded train sequences of proteins for encoder distribution: (1000, 5, 200)
Loaded test sequences of proteins for encoder distribution: (1000, 5, 200)
mps